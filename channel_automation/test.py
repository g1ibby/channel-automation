import os

import openai

openai.api_key = os.getenv("APP_ASSISTANT_TOKEN")

response = openai.ChatCompletion.create(
    model="gpt-4",
    messages=[
        {
            "role": "system",
            "content": 'You are an assistant responsible for creating social media posts based on newspaper articles. Here are your tasks:\n\n1. Generate a social media post of approximately 150 words based on the newspaper text I provide. \n   - **Title**: Each post should start with a title, enclosed in asterisks for bold text in Markdown format (e.g., `*Title Here*`). Follow the title with two empty lines.\n  - **Language**: The post must be written in Russian.\n  - **Tone**: Aim for a formal yet engaging tone. You may include emojis for emphasis.\n  - **Content**: If the newspaper text contains multiple unrelated sections, focus only on the first section for the social media post.\n  - **Paragraphs**: For longer posts, break the text into paragraphs to enhance readability.\n  - **Links**: Do not include website links or URLs at the end of the post unless specifically instructed to do so.\n  - **Format**: The post should be in Markdown format suitable for Telegram Messenger.\n  \n2. Create an English-language Google search query to find appropriate images to accompany the social media post.\n\nReturn the results in JSON format, using the fields `social_post` and `images_search`.\n\nExample Results:\n`{"social_post": "*Current Situation in Thailand* Таиланд в настоящее время сталкивается с тем, что, по прогнозам многих экспертов, перерастет в серьезную вспышку лихорадки денге, с вероятностью до 150 000 случаев заражения к концу года.", "images_search": "dengue"}`\n`{"social_post": "*Visa Policy Update* ⏺ Новое правительство Таиланда планирует увеличить срок безвизового пребывания российских туристов в стране с 30 до 90 дней.", "images_search": "thailand visa tourists"}`\n',
        },
        {
            "role": "user",
            "content": 'Consecrated by rich history and exalted by the faith of its local community, Wat Prayurawongsawas (known colloquially as Wat Prayoon) inspires awe with the grandeur of its towering Phra Borommathat Maha Chedi (principal stupa), whose pleasing bell-shaped proportions find glorifying aesthetic resonance in the 18 subsidiary stupas that punctuate the encircling gallery.\n"This chedi is one of a kind in Thailand," says Phra Brahmapundit, abbot of Wat Prayoon, as he sits serenely in the temple\'s ubosot (ordination hall), against the impressive backdrop of a golden Buddha that remains resplendent with gilding adroitly executed almost two centuries ago.\nThe chedi\'s most distinctive feature is its accessible interior space, where one can marvel at the massive central pillar of about 20m in height and 144 tonnes in weight. When construction began in 1828, under the reign of King Rama III, Wat Prayoon\'s principal stupa was structurally anachronistic: hollow chedis with a central pillar were more typical of the Ayutthaya period (1350–1767). "But no such chedi from the Ayutthaya period ever attained this size," the abbot remarks.\nPhra Brahmapundit proceeds to recount that, during World War II, a bomb intended for the strategic Memorial Bridge -- the only bridge spanning the Chao Phraya River at the time -- missed its target and detonated near the front entrance to the Wat Prayoon complex. The vihara (assembly hall) suffered severe damage, but the enormous Sukhothai-style statue of the Buddha enshrined therein was perfectly unscathed.\nThe roof of the ubosot was partly destroyed, consequently admitting rainwater that washed away original murals from three of the four walls.\nWhen observed from its exterior, the chedi seemed to be undisturbed. Nevertheless, Phra Brahmapundit hypothesises that the impact of the bomb eventually caused the central pillar to snap crosswise about 2m above its base and lean its considerable tonnage against the inner wall of the chedi.\nSurveying the structure in 2006, engineers from King Mongkut\'s Institute of Technology Ladkrabang (KMITL) found that the entire chedi was inclining towards the Chao Phraya River by about 1.2m. Fearing further leaning and potential collapse, the abbot initiated the chedi\'s restoration project in close consultation with KMITL and the Fine Arts Department.\nOwing to the need to preserve the unique pillar, the restoration effort necessitated nothing less than a virtuosic engineering feat. Six months were required to devise a plan that ultimately entailed the creation of a precautionary steel framework to surround the pillar, reinforcing the chedi\'s core structure with a solid steel armature to ensure future stability, and carefully lift the pillar into its original position by manoeuvring hydraulic jacks in a tight space.\nThe ubosot\'s interior. UNESCO/Chanchana Wongot\nDuring the chedi\'s restoration process (2006-2010), numerous precious relics were found in two theretofore undiscovered crypts. As evidenced by a newspaper dated Sept 25, 1954, which was left behind by an unsuccessful looter, the reputed worth of these relics had been attracting unwanted attention for quite some time.\nMany of the discovered relics (as well as the newspaper) are now kept in the Pharin Pariyattithammasala, a storied pavilion that was built during the reign of King Rama V and once served as Thailand\'s first public library. After years of disuse and disrepair, the pavilion was restored along with the chedi and converted into a small museum.\nThe exemplary restoration of the chedi and the adjoining pavilion at Wat Prayoon garnered an Award of Excellence in 2013 as part of the Unesco Asia-Pacific Awards for Cultural Heritage Conservation, which have been recognising successful conservation of structures, places and properties of heritage value in the region over the past two decades. The award citation not only applauds the "sophisticated understanding of a unique architectural typology from the early Rattanakosin era", but also underscores the project\'s "extensive social impact in the multicultural historic district of Kadeejeen".\nAccording to Phra Brahmapundit, the Unesco commendation gave Wat Prayoon the credibility to subsequently advocate for the culturally diverse Kadeejeen community by engaging in discussions with government officials and spearheading initiatives for sustainable local development, including the creatively designed Chao Phraya Sky Park (officially opened to the public with much fanfare in 2020) and the nearly complete riverside promenade stretching from Wat Prayoon to Wat Kalayanamit, which is wide enough to accommodate both pedestrians and biking tourists.\nToday, Phra Brahmapundit describes Wat Prayoon as a "reception area" for tourists wishing to experience the idiosyncratic charm of the Kadeejeen community. Indeed, the intriguing blend of Eastern and Western elements in Wat Prayoon\'s spectacular Khao Mo-- the largest manmade mountain outside of the Grand Palace -- highlights the harmonious multiculturalism that the abbot regards as the strength of this community.\nTourists head to Santa Cruz Church, near Wat Prayoon. UNESCO/Chairat Chongvattanakij\nJust a short walk from Wat Prayoon is Santa Cruz Church, an exquisite testament to the notable Portuguese presence in the area since the Thon Buri period (1767–1782). A stone\'s throw from Santa Cruz Church is one of the oldest Chinese shrines in the country, Kian Un Keng Shrine, which is dedicated to the goddess Guan Yin.\nVenturing deeper into the Kadeejeen community, one becomes immersed in the tranquillity of a residential neighbourhood of clean narrow alleys and densely packed houses. In the relaxed early afternoon, the aroma of a homecooked meal wafts listlessly through the air. A world away from Bangkok\'s dazzling shopping malls and the standardised offerings of chain convenience stores, some residents have transformed their homes into colourful shops and restaurants offering sweet and savoury culinary delights that reflect the heritage of cultural intermingling in this old district.\nBack at Wat Prayoon, Phra Brahmapundit notes that recent media portrayals, including popular Thai films like Love Destiny 2 (2022), have helped to enhance awareness of the temple\'s historical significance. Moreover, once its construction is complete, the southern Purple Line of the MRT subway system will make the temple and, by extension, the Kadeejeen district itself more accessible to curious visitors. Anticipating the future touristic influx, which he considers a "double-edged sword", the abbot stresses the importance of adhering to a master plan that aims to ensure sustainable growth in order to avoid environmental degradation and unbridled commercialisation.\nFor the abbot, a laudable development in recent years -- brought about in no small part through Wat Prayoon\'s persistent advocacy -- has been the enlargement of the boundaries of Rattanakosin Island, the historic heart of Bangkok, to include the western bank of the Chao Phraya River from Wat Prayoon to Wat Arun. This designation prohibits the construction of any tall building that would eclipse or detract from the visual appeal of heritage landmarks.\nKian Un Keng Shrine. UNESCO/Chui Yee Chin\n"We inherit, safeguard and leverage what we have," Phra Brahmapundit says. "The community\'s faith-based way of life endures. We have become recognised as a model for amiable coexistence and cultural preservation."\nAsked about his vision for Wat Prayoon\'s future, the abbot expresses optimism distilled from decades of practical wisdom: "The temple will be even more magnificent."\nChairat Chongvattanakij is a Thai-Canadian consultant specialising in content creation for the Public Information and Outreach team at Unesco Bangkok.\nKhao Mo, a Gothic-style mondop enshrining a Buddha statue. UNESCO/Chairat Chongvattanakij\nA mural depicting an unfinished chedi inside the vihara. UNESCO/Chui Yee Chin\nPharin Pariyattithammasala. UNESCO/Chui Yee Chin',
        },
    ],
    temperature=0.55,
    max_tokens=2261,
    top_p=0,
    frequency_penalty=0,
    presence_penalty=0,
)

first_choice = response.choices[0]
print(first_choice.message["content"])
